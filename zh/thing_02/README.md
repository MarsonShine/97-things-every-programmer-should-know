# 应用函数式编程原则

函数式编程最近再次受到主流编程界的关注。部分原因是函数范式的新兴特性能够很好地解决我们的行业向多核转变所带来的挑战。不过，这固然是一个重要的应用，但并不是这篇文章告诫大家要了解函数式编程的原因。

掌握函数式编程范式可以大大提高您在其他情况下编写代码的质量。如果你深刻理解并应用函数式范式，你的设计将表现出更高的参照透明度。

参照透明度是一种非常理想的特性：它意味着无论函数在何时何地被调用，在输入相同的情况下，函数都能始终产生相同的结果。也就是说，函数评估对可变状态的副作用依赖较少，理想情况下甚至完全不依赖。

命令式代码缺陷的一个主要原因是可变变量。每个人在阅读这篇文章时都会研究为什么在特定情况下某些值与预期不符。可见性语义可以帮助减轻这些隐藏的缺陷，或者至少可以大大缩小它们的位置范围，但它们真正的罪魁祸首实际上可能是采用过度可变性的设计。

在这一点上，我们当然得不到业界的帮助。面向对象的介绍默许了这种设计，因为它们经常展示由相对长寿的对象图组成的示例，这些对象乐此不疲地相互调用突变器方法，这是危险的。然而，通过精明的测试驱动设计，尤其是在确保[“模拟角色而非对象”](http://www.jmock.org/oopsla2004.pdf)的情况下，不必要的易变性是可以消除的。

最终的结果是，设计中通常会有更好的责任分配，更多更小的函数会作用于传递给它们的参数，而不是引用可变的成员变量。这样缺陷就会减少，而且调试起来通常也会更简单，因为在这些设计中，定位异常值的引入位置要比推断导致错误赋值的特定上下文要容易得多。这样一来，指代透明度就会高得多，而且学习函数式编程语言也能让这些思想深入骨髓，因为在函数式编程语言中，这种计算模式是常态。

当然，这种方法并非在所有情况下都是最佳的。例如，在面向对象系统中，与用户界面开发相比，这种风格在领域模型开发（即通过协作来分解业务规则的复杂性）方面往往能取得更好的效果。

掌握了函数式编程范式，你就能将学到的经验明智地应用到其他领域。您的对象系统（例如）将与参照透明性产生共鸣，并且比许多人认为的更接近函数式系统。事实上，有些人甚至断言，函数式编程和面向对象的顶点只是彼此的反映，是一种计算上的阴阳。

作者：[Edward Garson](http://programmer.97things.oreilly.com/wiki/index.php/Edward_Garson)