# 自动化您的编码标准

你可能也有过这样的经历。在项目开始时，每个人都有很多美好的愿望——称之为“新项目决议”。很多时候，这些决议都会写在文件中。关于代码的决议最终会写入项目的编码标准。在启动会议上，首席开发人员会仔细阅读这份文件，在最好的情况下，每个人都会同意尽量遵守这些决议。然而，一旦项目开始实施，这些良好的愿望就会被逐一抛弃。当项目最终交付时，代码看起来一团糟，似乎没有人知道它是如何变成这样的。

事情是什么时候出错的？可能在启动会议上就已经出现了问题。一些项目成员没有注意。还有一些人不理解重点。更糟糕的是，有些人不同意，已经在计划着他们自己的编码标准。最后，有些人明白了并表示同意，但当项目压力过大时，他们不得不放弃一些东西。对于希望获得更多功能的客户来说，格式化的代码并不能为你加分。此外，如果不是自动操作，遵循编码标准可能是一项相当枯燥的任务。试着手工缩进一个杂乱无章的类，你就会明白了。

既然问题如此严重，我们为什么还要制定编码标准呢？格式化代码的一个原因是，这样就不会有人因为以自己的方式格式化代码而”拥有“一段代码。我们可能希望防止开发人员使用某些反模式，以避免一些常见的错误。总之，编码标准应使项目工作更轻松，并从头至尾保持开发速度。因此，每个人都应就编码标准达成一致——如果一个开发人员使用三个空格缩进代码，而另一个开发人员使用四个空格缩进代码，那是无济于事的。

有很多工具可以用来生成代码质量报告，记录和维护编码标准，但这并不是全部的解决方案。在可能的情况下，它应该被自动执行。下面是几个例子：

- 确保代码格式化是构建流程的一部分，这样每个人每次编译代码时都会自动运行格式化。
- 使用静态代码分析工具扫描代码，查找不需要的反模式。如果发现，就中断构建。
- 学习如何配置这些工具，以便扫描自己的、项目特有的反模式。
- 不仅要测量测试覆盖率，还要自动检查结果。如果测试覆盖率过低，同样要中断构建。

尽量对所有你认为重要的事情都这样做。你不可能将所有你真正关心的事情都自动化。至于那些无法自动标记或修复的问题，可以将其视为自动化编码标准的一套补充指南，但您和您的同事可能不会严格遵守这些指南。

最后，编码标准应该是动态的，而不是静态的。随着项目的发展，项目的需求也会发生变化，一开始看似明智的做法，几个月后就不一定明智了。

作者：[Filip van Laenen](http://programmer.97things.oreilly.com/wiki/index.php/Filip_van_Laenen)