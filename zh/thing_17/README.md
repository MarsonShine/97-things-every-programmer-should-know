# 只注释代码无法表达的内容

理论与实践之间的差异在实践中比在理论中更大，这一观点当然也适用于注释。从理论上讲，对代码进行注释的总体思路听起来很有价值：为读者提供细节，解释发生了什么。还有什么比提供帮助更有用的呢？然而，在实践中，注释往往成为一种缺陷。与任何其他形式的写作一样，写好注释也需要技巧。其中很大一部分技巧在于知道何时不写注释。

如果代码不规范，编译器、解释器和其他工具肯定会反对。如果代码在某些方面存在功能错误，审查、静态分析、测试以及在生产环境中的日常使用将清除大部分错误。那么注释呢？Kernighan 和 Plauger 在《编程风格要素》（The *Elements of Programming Style* ）一书中指出：“如果注释是错误的，那么它的价值就是零（或负）”。然而，这些注释却常常在代码库中随处可见，并以一种编码错误永远无法企及的方式存活下来。它们不断地分散程序员的注意力，提供错误信息，潜移默化地拖累程序员的思维。

那么，那些技术上没有错误，但对代码没有任何价值的注释呢？这些注释就是噪音。照搬代码的注释不会给读者带来任何额外的东西——用代码和自然语言各说一遍并不能使其更真实或更现实。注释代码不是可执行代码，因此对读者和运行时都没有任何作用。它也会很快变得陈旧。版本相关注释和注释代码试图解决版本和历史问题。版本控制工具已经回答了这些问题（更有效）。

代码库中普遍存在的嘈杂注释和错误注释会促使程序员忽略所有注释，要么跳过它们，要么采取积极措施隐藏它们。程序员是机智的，他们会绕过任何被认为是破坏的东西：将注释折叠起来；切换着色方案，使注释和背景颜色相同；用脚本过滤掉注释。为了使代码库免受程序员聪明才智的误用，并降低忽略任何真正有价值的注释的风险，应将注释当作代码来处理。每条注释都应为读者增加一些价值，否则就是废物，应予以删除或重写。

那么，什么才算是有价值的注释呢？注释应该说一些代码不能说的，也不能说的。如果一个注释解释了代码本应该表达的意思，那么它就是在邀请你改变代码结构或者编码约定，以便代码能够自我说明。而不是弥补糟糕的方法或者类名，给它们改个名字。而不是在长函数中加注释，提取出其意图的小函数并为它们取名，从而让代码更具可读性。尽量用代码来表达尽可能多的信息。你在代码中能够表达的和你想要表达的之间的差距，就是一个有用注释的合理候选者。注释应该记录代码无法表达的内容，而不仅仅是代码没有表达的内容。

作者：[Kevlin Henney](http://programmer.97things.oreilly.com/wiki/index.php/Kevlin_Henney)