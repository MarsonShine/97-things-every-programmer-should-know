# 保持编译干净

你是否曾经看着一长串编译器警告，就像一篇关于糟糕编码的文章一样长，然后心想："你知道，我真的应该做点什么？...但我现在没有时间..."另一方面，你是否也曾看过编译器中出现的一个警告，然后就把它修复了呢？

当我从头开始一个新项目时，没有警告，没有杂乱，没有问题。但随着代码库的增长，如果我不注意，杂乱、垃圾、警告和问题就会开始堆积起来。当出现大量噪音时，就很难在成百上千个我并不关心的警告中找到我真正想要阅读的警告。

为了让警告重新发挥作用，我尝试对构建过程中的警告采取零容忍政策。即使警告并不重要，我也会处理。如果不重要，但仍然相关，我也会修正它。如果编译器对潜在的空指针异常发出警告，即使我“知道”这个问题永远不会在生产中出现，我也会修复它。如果嵌入式文档（Javadoc 或类似文档）中提到的参数已被删除或重命名，我会清理文档。

如果是我真的不关心的问题，而且这也真的无关紧要，我就会询问团队是否可以更改我们的警告策略。例如，我发现记录一个方法的参数和返回值在很多情况下并不会增加任何价值，所以如果缺少这些参数和返回值也不应该是一个警告。或者，升级到新版本的编程语言可能会让之前没有问题的代码现在发出警告。例如，Java 5 引入泛型后，所有未指定泛型类型参数的旧代码都会发出警告。这种警告我可不想被唠叨（至少现在还不想）。拥有一套与现实脱节的警告对任何人都没有好处。

通过确保构建始终是干净的，我就不必在每次遇到警告时都认为它无关紧要。忽略事情是一种脑力劳动，而我需要尽可能摆脱所有不必要的脑力劳动。拥有一个干净的构建也会让别人更容易接手我的工作。如果我留下了警告，别人就必须仔细研究哪些是相关的，哪些是不相关的。或者更有可能的是，忽略所有警告，包括重要的警告。

来自构建的警告是有用的。你只需要消除噪音，就能开始注意到它们。不要等待大清理。当出现你不想看到的东西时，立即处理它。要么修复警告源，要么抑制警告，要么修复工具的警告策略。保持编译干净不仅是要保证没有编译错误或测试失败：警告也是代码卫生的重要组成部分。

作者：[Johannes Brodwall](http://programmer.97things.oreilly.com/wiki/index.php/Johannes_Brodwall)